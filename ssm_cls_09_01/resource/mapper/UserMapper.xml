<?xml version="1.0" encoding="UTF-8" ?>
 <!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
     "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bawei.dao.UserDao">
	<!-- 查询所有的用户信息 -->
	<select id="findUserAll" resultMap="userMap">
		SELECT user.*,userdetail.* FROM USER JOIN userdetail ON user.id=userdetail.`userId`;
	</select>
	<resultMap type="User" id="userMap">
		<id property="id" column="id"/>
		<result property="userName" column="userName"/>
		<result property="password" column="password"/>
		<!-- 主要针对对象属性和数据库字段的映射   
		property="映射到实体类的对象属性" pojo的对象属性
		javaType="映射到实体类的对象属性的类型"
		resultMap="指定当前实体类映射名"
		-->
		<association property="userDetail" javaType="UserDetail" resultMap="userdetailMap"></association>
	</resultMap>
	<resultMap type="UserDetail" id="userdetailMap">
		<id property="id" column="id"/>
		<result property="nikeName" column="nikeName"/>
		<result property="sex" column="sex"/>
		<result property="telephone" column="telephone"/>
		<result property="email" column="email"/>
		<result property="company" column="company"/>
		<result property="dept" column="dept"/>
		<result property="duty" column="duty"/>
		<result property="photo" column="photo"/>
	</resultMap>
	<!-- 新增用户数据 -->
	<insert id="insertUser" parameterType="User">
		INSERT INTO user(userName,password) VALUES (#{userName}, #{password})
		<!-- 新增User后获取新增的主键id 
		<selectKey>用于插入数据后获取主键id
		resultType="结果类型 主键id的类型"
		order="AFTER mysql数据库中先执行insert语句再生成主键id"
		keyProperty="需要获取值的属性 主键的名称"-->
		<selectKey resultType="java.lang.Integer" order="AFTER" keyProperty="id">
			select last_insert_id() as id
		</selectKey>
	</insert>
	
	<!-- 根据id查询用户实体 -->
	<select id="findUserById" resultType="User">
		select * from user where id=#{id}
	</select>
	<!-- 删除用户实体 -->
	<delete id="deleteUser" parameterType="int">
		delete from user where id=#{id}
	</delete>
</mapper>









